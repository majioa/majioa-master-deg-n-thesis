RANDOMIZE       PROC;(IN AX=0 - NO TIMER)
        PUSH    AX
        PUSH    DX
        MOV     CS:[RND_TYPE],AX
        XOR     AX,AX
        PUSH    AX
        MOV     AX,0B6H
        MOV     DX,43H
        OUT     DX,AX
        POP     AX
        OUT     42H,AL
        MOV     AL,AH
        OUT     42H,AL
        IN      AL,61H
        OR      AL,00000001B
        OUT     61H,AL
        POP     DX
        POP     AX
        RET
ENDP
RND     PROC;(IN BX - RANGE)
        PUSH    BX
        PUSH    DX
        MOV     AX,CS:[RND_TYPE]
        OR      AX,AX
        JZ      RANDOMIZE_NO_TIMER
        XOR     AL,AL
        OUT     70H,AL
        JMP     $+2
        IN      AL,71H
        MOV     AH,AL
        MOV     AL,2
        OUT     70H,AL
        JMP     $+2
        IN      AL,71H
RANDOMIZE_NO_TIMER:
        MOV     CS:[INVERTIVE],AX
        MOV     DX,1
        XOR     AX,AX
        DIV     BX
        MOV     CS:[DIVIDER],AX
        MOV     AX,86H
        MOV     DX,43H
        OUT     DX,AX
        IN      AL,42H
        MOV     AH,AL
        IN      AL,42H
        XCHG    AH,AL
        XOR     DX,DX
        XOR     AX,CS:[INVERTIVE]
        DIV     CS:[DIVIDER]
        POP     DX
        POP     BX
        RET
INVERTIVE       DW      0
DIVIDER         DW      0
RND_TYPE        DW      0
ENDP
